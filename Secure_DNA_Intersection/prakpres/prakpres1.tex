\documentclass{beamer}
%
% Choose how your presentation looks.
%
% For more themes, color themes and font themes, see:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
%
\mode<presentation>
{
   
  \usetheme{IMI} 
  %\usetheme{default}      % or try Darmstadt, Madrid, Warsaw, ...
  \usecolortheme{default} % or try albatross, beaver, crane, ...
  \usefonttheme{default}  % or try serif, structurebold, ...
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]

} 

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{enumitem}
\newlist{arrowlist}{itemize}{1}
\setlist[arrowlist]{label=$\Rightarrow$}
\usepackage{tikz}
\tikzset{
	every overlay node/.style={
		%draw=black,fill=white,rounded corners,
		anchor=north west,
	},
}
% Usage:
% \tikzoverlay at (-1cm,-5cm) {content};
% or
% \tikzoverlay[text width=5cm] at (-1cm,-5cm) {content};
\def\tikzoverlay{%
	\tikz[baseline,overlay]\node[every overlay node]
}%

\title[Privatly computing Set-Intersection]{Privatly computing Set-Intersection using Bloom Filters}
\author{Niklas Jobst}
\institute{TCS - Universität zu Lübeck}
\date{\today}

\begin{document}


% Uncomment these lines for an automatically generated outline.
%\begin{frame}{Outline}
%  \tableofcontents
%\end{frame}
\section{Einleitung}
\begin{frame}{Abschätzung der Elemente in einem Bloomfilter}
	$$ |X| = \frac{ln( \frac{z}{m})}{k* ln(1- \frac{1}{m})}$$
	
	\begin{arrowlist}
		\item Basiert auf Abschätzung der False-positive Wahrscheinlichkeit in einem Bloomfilter:
		\item 	$ z = m*(1 -\frac{1}{m})\textsuperscript{k* X}$ 
	\end{arrowlist}
	
\end{frame}

\section{Algorithmus}


\begin{frame}{Algorithmus basierend auf Elgamal}
	\footnotesize
		\vskip 0.3cm
	\tikzoverlay (n1) at (-0.5cm,3cm) {
		\begin{minipage}{0.45\textwidth}
			\begin{block}{\textbf{Client} }
			\begin{arrowlist}
				\item Erstellt Bloom Filter der Daten
				\item Verschlüsselt jede Stelle des Bloom Filters mittels ElGamal

			\end{arrowlist}
				\quad  \ \ $(R_i, S_i)=(g \textsuperscript{r\textsubscript{i}},pk\textsuperscript{r\textsubscript{i}}*g\textsuperscript{1-BF\textsubscript{1}[i]})$
			\end{block}
		\end{minipage}
	};
	
	\tikzoverlay (n2) at (6.7cm,3.5cm) {
		\begin{minipage}{0.45\textwidth}
			\begin{block}{\textbf{Server}}
			\begin{arrowlist}

				\item Erstellt Bloom Filter der Daten
				\item Selektiert jene Stellen Stellen in dem BF die den Eintrag null besitzen.
				\item Multipliziert an diesen Stellen die Werte des Ciphertextes vom Client auf 
				\item Rerandomisiert die entstandenen Ergebnisse
				\quad  \ \	$$ V = (g \textsuperscript{s} * \Pi_{i:BF_{2}[i] = 0} R_{i} )$$
					$$ W = (pk \textsuperscript{s} * \Pi_{i:BF_{2}[i] = 0} S_{i} )$$ \\

			\end{arrowlist}
			\end{block}
		\end{minipage}
	};
	
	\tikzoverlay (n3) at (-0.5cm,0cm) {
		\begin{minipage}{0.45\textwidth}
			\begin{block}{}
						\begin{arrowlist}
							\item Alice entschlüsselt mit sk Ciphertext von Bob
							\item Bestimmt Anzahl der Einträge  an denen beide Bloom Filter null sind
							\item Berechnet die Set-Union der BF
						\end{arrowlist}
			\end{block}
		\end{minipage}
	};
	
	\begin{tikzpicture}[overlay]

	\draw[->,>=latex, line width=0.1cm] (4.8, 1)--(6.9, 1) node[above left] { $ \ [pk, (R_i, S_i)] \ \ $};
	\draw[->,>=latex, line width=0.1cm] (6.9, -1)--(4.8, -1) node[above right] {  $ \ \ (V,W) \ \ $};

	
	\end{tikzpicture}
	
	
\end{frame}

\begin{frame}{Paillier - Verfahren}

	\textbf{Schlüsselerzeugung:}\\
	
	
	Das Schlüsselpaar wird folgendermaßen generiert:
	Der Client wählt zwei Primzahlen p,q , mit ggt(pq, (p-1)(q-1))= 0. Des weiteren wird der Generator g so gewählt, sodass $ g \in (\mathbb{Z}/ n^{2} \mathbb{Z}) $ und$ n $ die Ordnung von g teilt.
	Das Schlüsselpaar wird dann folgendermaßen gebildet.
	\begin{itemize}	
		\item Secrect key: $ \lambda = kgV(p-1, q-1) $
		\item Public Key: $(n,g)$	
	\end{itemize}
	
	

\end{frame}

\begin{frame}
		\textbf{Verschlüsselung:}\\
		
		
		Zur Verschlüsselung einer Nachricht $ m \in \mathbb{Z} $ wählt der Client zunächst eine Zufalls Zahl $ r $ wobei $ 0 \leq r \leq n $
		Dann berechnet sich der Ciphertext $ c = g^{m}*r^{n} \mod\ n^{2} $\
		\newline
		\textbf{Entschlüsselung:}\\
		Der Plaintext kann folgendermaßen berechnet werden: $ m = L(c^{\lambda} \mod n^{2}) * \mu mod n $
		\newline
		\textbf{Homomorphie:}\\
		Paillier ist homomorph gegenüber der Addition.
		
		$$ E(m \textsubscript{1} + m \textsubscript{2}) = (E(m \textsubscript{1}) + E(m \textsubscript{2}))$$
\end{frame}

\begin{frame}{Algorithmus basierend auf Paillier}
	\footnotesize
	\vskip 0.3cm
	\tikzoverlay (n1) at (-0.5cm,3cm) {
		\begin{minipage}{0.45\textwidth}
			\begin{block}{\textbf{Client} }
				\begin{arrowlist}
						\item Erstellt Bloom Filter ihrer Daten
						\item Invertiert jede Stelle des Bloomfilters.
						\item Verschlüsselt jede Stelle ihres Bloomfilters mittels Paillier
						
					\end{arrowlist}
					\quad  \ \ $c_{1-m} =(g^{m}*r^{n}) \ mod \ n^{2} $
			\end{block}
		\end{minipage}
	};
	
	\tikzoverlay (n2) at (6.7cm,3.5cm) {
		\begin{minipage}{0.45\textwidth}
			\begin{block}{\textbf{Server}}
				\begin{arrowlist}
					
						\item Erstellt für jedes Element des Datensatzes einen Bloomfilter seiner Daten
						\item Selektiert in jedem Blommfilter jene Stellen die den Eintrag Eins besitzen.
						\item Addiert an diesen Stellen die Werte des Ciphertextes des Clients auf 
						\item Rerandomisiert die entstandenen Ergebnisse mit verschlüsselter Null
						\quad  \ \	$$ Rerand \ e_{j} = (ej \ *  \ encrypt_{pailier}(0) )$$

					
				\end{arrowlist}
			\end{block}
		\end{minipage}
	};
	
	\tikzoverlay (n3) at (-0.5cm,0cm) {
		\begin{minipage}{0.45\textwidth}
			\begin{block}{}
				\begin{arrowlist}
					\item Client entschlüsselt mit sk Ciphertexte von Server
					\item Anzahl der entschlüsselten Nullen entspricht der Anzahl der sich überschneidenden Elemente
				\end{arrowlist}
			\end{block}
		\end{minipage}
	};
	
	\begin{tikzpicture}[overlay]
	
	\draw[->,>=latex, line width=0.1cm] (4.8, 1)--(6.9, 1) node[above left] { $  [pk, c] \ \ \ \ $};
	\draw[->,>=latex, line width=0.1cm] (6.9, -1)--(4.8, -1) node[above right] {  $ \ \ rerand(e_{1-j}) \ \ $};
	
	
	\end{tikzpicture}
	
	
\end{frame}

\begin{frame}{Ergebnisse - Elgamal }
	
	\begin{arrowlist}
		\item Dauer für Vergleich des gesamten Exomes bei wenigen Minuten.
		\item Laufzeit Unabhängig davon wie stark die Überschneidung zwischen zwischen den Datensätzen ist. 
	\end{arrowlist}

 \begin{table}[h]
	\begin{tabular}{c|c|c|c|c}
		Überschneidung&14000&7500&5000&2000\\
		\hline
		Runtime (sec)& 221&247&211&222\\
		Abw. zur Überschn.& 0.01\%& 3.3\%&8.8\%&36.8\%\\
			 		
	\end{tabular}
	\caption{Hashfunktionen : 14, Anzahl Bloomfilter Bits:3029660, Größe der Datensätze: 15000 SNPs }
	\label{tab:meinetabelle1}
	
	
\end{table}


\end{frame}	
\begin{frame}
\begin{table}[h]
			 	
	\begin{tabular}{c|c|c|c|c}
	    Array& 1442696&1009887&577079&144270\\
	    \hline
		Runtime (sec)& 108&83&47&11\\
		Abweichung&4\%&6\%&13\%&51\%\\

			 		
	\end{tabular}
	\caption{Datensatz 1000 SNPs, Überschneidung 100, Hashfunktionen: 10 }
	\label{tab:meinetabelle2}
\end{table}

\begin{arrowlist}
	\item Die Laufzeit ist linear abhängig zur Anzahl der Bloomfilterbits
	\item Die Stärke der Abweichung ist ebenfalls linear abhängig zur Anzahl der Bloomfilter Bits
\end{arrowlist}
\end{frame}			 
	
\begin{frame}
	\begin{table}[h]
		
		\begin{tabular}{c|c|c|c|c|c}
			Hashf.&1&4&7&10&14\\
			\hline
			Runtime (sec)&7&27&44&62&104\\
			Abweichung&11\%&13\%&10\%&9\%&9\%\\
			
			
		\end{tabular}
		\caption{Datensatz 1000 SNPs, Überschneidung 100, Array: 504944 }
		\label{tab:meinetabelle4}
	\end{table}
	
	\begin{arrowlist}
		\item Die Laufzeit ist linear abhängig zur Anzahl der Bloomfilterbits
		\item Die Stärke der Abweichung ist ebenfalls linear abhängig zur Anzahl der Bloomfilter Bits
	\end{arrowlist}
\end{frame}


\begin{frame}{Ergebnisse-Paillier}
	\begin{table}[h]
		
		\begin{tabular}{c|c|c|c|c|c}
			Array&14139&12119&10099&8080\\
			\hline
			Runtime (sec)&219&194&183&163\\
			Abweichung&1\%&4\%&6\%&24\%\\
			
			
		\end{tabular}
		\caption{Hashf.7, Überschneidung 100, SNPs 1000 }
		\label{tab:meinetabelle5}
	\end{table}
	
	\begin{arrowlist}
		\item Paillier deutlich langsamer als Elgamal
		\item Benötigt deutlich kleinere Bloomfilter für selbe Genauigkeit, jedoch ist die Bitweise Verschlüsselung sehr langsam
	\end{arrowlist}
\end{frame}
\begin{frame}
	\begin{table}[h]
		
		\begin{tabular}{c|c|c|c|c|c}
			Array&141385&100989&75742\\
			\hline
			Runtime (sec)&2420&2318&2007\\
			Abweichung&1\%&4\%& 13\%\\
			
			
		\end{tabular}
		\caption{Hashf.7, Überschneidung 7500, SNPs 15000 }
		\label{tab:meinetabelle6}
	\end{table}
	
	\begin{arrowlist}
		\item Paillier deutlich langsamer als Elgamal

		
	\end{arrowlist}

\end{frame}

\begin{frame}
	\begin{table}[h]
		
		\begin{tabular}{c|c|c|c|c|c}
			Array&201978\\
			\hline
			Runtime (sec)&4243\\
			Abweichung&0.1\%\\
			
			
		\end{tabular}
		\caption{Hashf.7, Überschneidung 7500, SNPs 15000 }
		\label{tab:meinetabelle7}
	\end{table}
	
	\begin{arrowlist}
		\item Paillier deutlich langsamer als Elgamal
		
		
	\end{arrowlist}
	
\end{frame}
\end{document}
